{%- for option_name in option_names -%}
  {%- assign name = option_name | strip | downcase -%}
  {%- if product.options_by_name[name] != blank -%}
    {%- assign product_option = product.options_by_name[name] -%}
    {%- assign option_position = product_option.position -%}
    {% capture property_name %}option{{ option_position }}{% endcapture %}

    {%- if settings.card_variant_list_limit > 0 and product_option.values.size > settings.card_variant_list_limit -%}
      {%- assign display_type = 'count' -%}
    {%- endif -%}

    {%- if product_option.values.size > 0 -%}
      {%- assign swatch_count = product_option.values | map: 'swatch' | compact | size -%}
      {%- assign display_swatches = false -%}
      {%- if swatch_count == product_option.values.size -%}
        {%- assign display_swatches = true -%}
      {%- endif -%}
      {%- if display_type == 'list' -%}
        {%- if display_swatches == true -%}
          <div>
            <span class="visually-hidden">{{ product_option.name }}</span>
            <ul class="card-product-variants__list card-product-variants__list--swatches" role="list">
              {%- for value in product_option.values -%}
                {%- liquid
                  assign option_disabled = true
                  if value.available
                    assign option_disabled = false
                  endif
                  assign variant_match = product.variants | where: property_name, value | first
                -%}
                <li>
                  <div class="card-product-variants__swatch {% if option_disabled == true %}disabled{% endif %}">
                    {%- if variant_match != blank -%}
                      <a href="{{ variant_match.url }}" class="card-product-variants__swatch-link">
                    {%- endif -%}

                    {% if option_disabled -%}
                      <span class="visually-hidden">
                        {{- 'products.product.value_unavailable' | t: option_value: value -}}
                      </span>
                    {%- else -%}
                      <span class="visually-hidden">{{ value }}</span>
                    {%- endif -%}
                    {%- render 'swatch', swatch: value.swatch, size: 'medium' -%}

                    {%- if variant_match != blank -%}
                      </a>
                    {%- endif -%}

                  </div>
                </li>
              {%- endfor -%}
            </ul>
          </div>
        {%- else -%}
          <div>
            <span class="visually-hidden">{{ product_option.name }}</span>
            <ul class="card-product-variants__list" role="list">
              {%- for value in product_option.values -%}
                <li class="caption caption-sm">
                  {% if option_disabled -%}
                    <s>{{ value }}</s>
                  {%- else -%}
                    <span>{{ value }}</span>
                  {%- endif -%}
                </li>
              {%- endfor -%}
            </ul>
          </div>
        {%- endif -%}
      {%- elsif display_type == 'count' %}
        <p class="caption caption-sm">
          <span class="visually-hidden">{{ product_option.name }}</span>
          {%- if count_translation -%}
            {{- count_translation | t: count: product_option.values.size -}}
          {%- endif -%}
          {%- if count_translation_custom != nil -%}
            {%- if product_option.values.size > 1 -%}
              {%- assign option_names_pluralized = option_name -%}
              {%- if count_translation_custom[forloop.index0] and count_translation_custom[forloop.index0] != blank -%}
                {%- assign option_names_pluralized = count_translation_custom[forloop.index0] -%}
              {%- endif -%}
              <span>{{- 'products.product.variants.other.count' | t: count: product_option.values.size, option_name: option_names_pluralized -}}</span>
            {%- else -%}
              <span>{{- 'products.product.variants.other.count' | t: count: product_option.values.size, option_name: option_name -}}</span>
            {%- endif -%}
          {%- endif -%}
        </p>
      {%- endif -%}
    {%- endif -%}
  {%- endif -%}
{%- endfor -%}